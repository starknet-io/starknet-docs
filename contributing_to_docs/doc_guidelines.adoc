[id="contributing-to-docs-doc-guidelines"]
= Documentation guidelines
// include::_attributes/common-attributes.adoc
:toc: macro

// These guidelines are based on the guidelines for OpenShift documentation. Some sections of the original documentation are commented out. In the future, once it is determined they are not relevant to Starknet docs, those sections might be removed.

The documentation guidelines for Starknet build on top of the
link:https://redhat-documentation.github.io/modular-docs/[_Red Hat modular docs reference guide_]. However, because Antora does not natively account for assemblies, Starknet documentation does not use assemblies, so when reading this guide, focus on the information related to modularizing content based on the three major information types:

* _Conceptual_
* _Procedural_
* _Reference_

These _Documentation guidelines_ are primarily concerned with the modular structure and AsciiDoc / Antora requirements for building Starknet documention. For style guidance, use these style guides in the following order:

. xref:starknet_docs_style_guide.adoc[_Starknet documentation style guide_] Reference this guide first. It provides guidance that is specific to Starknet documentation.
. link:https://redhat-documentation.github.io/supplementary-style-guide[_Red Hat supplementary style guide for product documentation_]. This guide overrides certain guidance from the _Google developer documentation style guide_.
. link:https://developers.google.com/style[_Google developer documentation style guide_]

If you cannot find helpful information or if you must deviate from the guidance in any of these guides, open an issue in the https://github.com/starknet-io/starknet-docs-style-guide/issues[Starknet documentation style guide repo]. The stakeholders can then discuss and determine if and how to address the issue.

toc::[]

== General text editor guidelines

* Set your editor to strip trailing whitespace.
* The end of each file should have an empty line.
// * Do *not* hard wrap lines at 80 characters (or at any other length).
// +
// It is not necessary to update existing content to unwrap lines, but you can remove existing hard wrapping from any lines that you are currently working in.

[id="module-file-metadata"]
== Module file metadata
Every module should be placed in a logical directory under `/components/StarkNet/modules` with the following metadata at the top of the file:

----
[id="<module-anchor>_{context}"]                                   <1>
= Module title                                                     <2>
----

<1> A module anchor with `{context}` that must be lowercase and must match the module's file name.
<2> Human readable title. To ensure consistency in the results of the
leveloffset values in include statements, you must use a level one heading
( = ) for the module title.

Example:

----

[id="cli-basic-commands_{context}"]
= Basic CLI commands
----

[id="snippet-file-metadata"]
== Text snippet file metadata
Every text snippet should be placed in the `partials` folder for the module in which they are used, and should contain the following metadata at the top:

[source,adoc]
----
// Text snippet included in the following files: <1>
//
// * list of files where this text snippet is included
----

<1> List of modules in which this text snippet is included.

[NOTE]
====
An anchor ID and human readable title are not required metadata. This type of component is text only and not intended to be published or cross referenced on its own. See <<writing-text-snippets>>.
====

.Example:

[source,adoc]
----
// Text snippet included in the following files:
//
// * getting_started/pages/account_setup.adoc
// * getting_started/pages/deploying_contracts.adoc

[NOTE]
====
Starknet accounts are smart contracts. As such, creating one involves sending a transaction, and takes a bit longer than creating an EOA on other networks.
You can learn more in https://docs.starknet.io/documentation/architecture_and_concepts/Account_Abstraction/introduction/[What is an account?].
====
----

[id="attribute-files"]
== Attribute files

[quote,AsciiDoc Language Documentation]
____
Document attributes are effectively document-scoped variables for the AsciiDoc language. The AsciiDoc language defines a set of built-in attributes, and also allows the author (or extensions) to define additional document attributes, which may replace built-in attributes when permitted.
____

For detailed information on attributes in AsciiDocs, see link:https://docs.asciidoctor.org/asciidoc/latest/attributes/document-attributes/[Document Attributes] in the _AsciiDoc Language Documentation_.

If an attribute is used in multiple files, it is helpful to place those attributes in a single attributes file, and use an `include` statement to import those attributes where relevant. The attribute file is a normal AsciiDoc file.

All attribute files must be placed in the `partials` directory for the primary module that uses them. Reference an attributes file using the following syntax:

 include::partial$attributes/<file_name>.adoc[]

For example:

 include::partial$attributes/attributes.adoc[]

If files in more than one module reference the same attribute file, use the following syntax, or suggest a new strategy in a Github issue:

. Create a symlink to the attributes file in the `partials` directory of the parent module for the file that includes the attributes file.

For example: Consider the following files:

* Attributes file: `/components/Starknet/modules/ROOT/partials/attributes.adoc`
* Content file: `/components/Starknet/modules/useful_info/pages/audit.adoc`

To include `attributes.adoc` in `audit.adoc`:

 include::$ROOT:partial$attributes.adoc[]


== File names

Try to shorten the file name as much as possible _without_ abbreviating important terms that might cause confusion. For example, the `managing-authorization-policies.adoc` file name would be appropriate for an assembly titled "Managing Authorization Policies".

== Directory names

If you create a directory with a multiple-word name, separate each word with an underscore, for example `backup_and_restore`.

Do not create or rename a top-level directory in the repository and topic map without checking with the docs team first.

// [TIP]
// ====
// To create the symbolic links:
//
// . Navigate to the directory that you need to add the links in.
// . Use the following command to create a symbolic link:
// +
// ----
// $ ln -s <target_directory> <link_name>
// ----
// +
// For example, if you are creating the links in a directory that is two levels deep, such as `cli_reference/cli`, use the following commands:
// +
// ----
// $ ln -s ../../images/ images
// $ ln -s ../../modules/ modules
// $ ln -s ../../snippets/ snippets
// $ ln -s ../../_attributes/ attributes
// ----
// +
// Be sure to adjust the number of levels to back up (`../`) depending on how deep your directory is.
//
// If you accidentally create an incorrect link, you can remove that link by using `unlink <link_name>`.
// ====

== titles and section headings

Use sentence case in all titles and section headings. See http://www.titlecase.com/ or https://convertcase.net/ for a conversion tool.

Try to be as descriptive as possible with the title or section headings
without making them unnecessarily long. For procedural modules,
use a gerund form in headings, such as:

* Creating
* Managing
* Using

// Do not use "Overview" as a heading.

// Do not use backticks or other markup in assembly or module headings.

Use only one level 1 heading (`=`) in any file.

=== Discrete headings

If you have a section heading that you do not want to appear in the TOC, for example, if you think that some section is not worth showing up or if there are already too many nested levels, you can use a discrete heading:

https://docs.asciidoctor.org/asciidoc/latest/blocks/discrete-headings/

To use a discrete heading, just add `[discrete]` to the line before your unique ID. For example:

----
[discrete]
[id="managing-authorization-policies_{context}"]
== Managing authorization policies
----

== Anchoring titles and section headings

All titles and section headings must have an anchor ID. The anchor ID must be similar to the title or section heading.

You must add the `{context}` variable to the end of each anchor ID in module files. When called, the `{context}` variable is resolved into the value declared in the `:context:` attribute in the corresponding assembly file. This enables cross-referencing to module IDs in context when a module is included in multiple locations.

[NOTE]
====
The `{context}` variable must be preceded by an underscore (`_`) when declared in an anchor ID.
====

The following is an example of an anchor ID for a module file title:

----
[id="sending-notifications-to-external-systems_{context}"]
= Sending notifications to external systems
----

The following is an example of an anchor ID for a second level (`==`) heading:

----
[id="deployment-scaling-benefits_{context}"]
== Deployment and scaling benefits
----

// === Anchoring "Prerequisites", "Additional resources", and "Next steps" titles
//
// Use unique IDs for "Prerequisites", "Additional resources", and "Next steps" titles. You can add the prefixes `prerequisites_`, `additional-resources_`, or `next-steps_` to a unique string that describes the topic. The unique string can match the value assigned to the `:context:` attribute in the assembly.
//
// [NOTE]
// ====
// The `prerequisites_`, `additional-resources_`, and `next-steps_` prefixes must end with an underscore (`_`) when declared in an anchor ID in an assembly.
// ====
//
// The following examples include IDs that are unique to the "Configuring alert notifications" assembly:
//
// *Example unique ID for a "Prerequisites" title*
//
// ----
// [id="prerequisites_configuring-alert-notifications"]
// == Prerequisites
// ----
//
// *Example unique ID for an "Additional resources" title*
//
// ----
// [role="_additional-resources"]
// [id="additional-resources_configuring-alert-notifications"]
// == Additional resources
// ----
//
// *Example unique ID for a "Next steps" title*
//
// ----
// [id="next-steps_configuring-alert-notifications"]
// == Next steps
// ----

// == Writing assemblies
// An _assembly_ is a collection of modules that describes how to accomplish a user story.
//
// Avoid link:https://redhat-documentation.github.io/modular-docs/#nesting-assemblies[nesting assemblies] in other assembly files. You can create more complicated document structures by modifying the link:https://github.com/openshift/openshift-docs/tree/main/_topic_maps[topic maps].
//
// For more information about forming assemblies, see the
// link:https://redhat-documentation.github.io/modular-docs/#forming-assemblies[_Red Hat modular docs reference guide_] and the link:https://raw.githubusercontent.com/redhat-documentation/modular-docs/master/modular-docs-manual/files/TEMPLATE_ASSEMBLY_a-collection-of-modules.adoc[assembly template].
//
// [NOTE]
// ====
// When using the "Prerequisites", "Next steps", or "Additional resources" headings in an assembly, use `==` formatting, such as `== Prerequisites` or `== Additional resources`. Use of this heading syntax at the assembly level indicates that the sections relate to the whole assembly.
//
// Only use `.` formatting (`.Additional resources`) to follow a module in an assembly. Because you cannot use the xrefs in modules, this functions as a _trailing include_ at the assembly level, where the `.` formatting of the `include` statement indicates that the resource applies specifically to the module and not to the assembly.
// ====

== Writing concepts
A _concept_ contains information to support the tasks that users want to do and
must not include task information like commands or numbered steps.

Avoid using gerunds in concept titles. "About <concept>"
is a common concept module title.

For more information about creating concept modules, see the
link:https://redhat-documentation.github.io/modular-docs/#creating-concept-modules[_Red Hat modular docs reference guide_] and the link:https://raw.githubusercontent.com/redhat-documentation/modular-docs/master/modular-docs-manual/files/TEMPLATE_CONCEPT_concept-explanation.adoc[concept template].

== Writing procedural topics
A _procedure_ contains the steps that users follow to complete a process or task. Procedures contain ordered steps and explicit commands.

Use a gerund in the procedure title, such as "Creating".

For more information about writing procedural topics, see the
link:https://redhat-documentation.github.io/modular-docs/#creating-procedure-modules[_Red Hat modular docs reference guide_] and the link:https://raw.githubusercontent.com/redhat-documentation/modular-docs/master/modular-docs-manual/files/TEMPLATE_PROCEDURE_doing-one-procedure.adoc[procedure template].

[id="writing-text-snippets"]
== Writing text snippets
A _text snippet_ is an optional component that lets you reuse content in multiple modules and assemblies. Text snippets are not a substitute for modules but instead are a more granular form of content reuse.

While a module is content that a reader can understand on its own (like an article) or as part of a larger body of work (like a guide), a text snippet is not self-contained and is not intended to be published or cross referenced on its own.

Examples include the following:

* Admonitions that appear in multiple locations.
* An introductory paragraph that appears in multiple locations.
* The same series of steps that appear in multiple procedural modules.
* A deprecation statement that appears in multiple sets of release notes.

Example:

You could write the following paragraph once and include it in each location that explains how to install a cluster using the installer-provisioned default values:

[source,adoc]
----
In {product-title} version {product-version}, you can install a cluster on {cloud-provider-first} ({cloud-provider}) that uses the default configuration options.
----

For more information about creating text snippets, see the
link:https://redhat-documentation.github.io/modular-docs/#using-text-snippets[_Red Hat modular docs reference guide_].

// == IP addresses
//
// You can include IPv4 addresses from test clusters in examples in the documentation, as long as they are private. Private IPv4 addresses fall into one of the following ranges:
//
// * 10.0.0.0 to 10.255.255.255 (class A address block 10.0.0.0/8)
// * 172.16.0.0 to 172.31.255.255 (class B address block 172.16.0.0/12)
// * 192.168.0.0 to 192.168.255.255 (class C address block 192.168.0.0/16)
//
// Replace all public IP addresses with an address from the following blocks. These address blocks are reserved for documentation:
//
// * 192.0.2.0 to 192.0.2.255 (TEST-NET-1 address block 192.0.2.0/24)
// * 198.51.100.0 to 198.51.100.255 (TEST-NET-2 address block 198.51.100.0/24)
// * 203.0.113.0 to 203.0.113.255 (TEST-NET-3 address block 203.0.113.0/24)
//
// [NOTE]
// ====
// There might be advanced networking examples that require specific IP addresses, or cloud provider-specific examples that require a public IP address. Contact a subject matter expert if you need assistance with replacing IP addresses.
// ====

=== Example URLs
To provide an example URL path that you do not want to render as a hyperlink, use this format:

....
`\https://www.example.com`
....


=== Links to external websites

If you want to link to a third-party website:

* Do not create a hyperlink.
* Use the site top level URL as text.
* Provide the title of the page to search for on the site.

.Example

[source,adoc]
----
For more information, see _A specific page_ at \http://www.example.com/.
----

A hyperlink to a page on a third-party website is convenient and user-friendly _as long as the link works_. The problem is that a third-party site can move pages without notification, in which case that user-friendly link can become a user-unfriendly broken link, and broken links also impact our search engine rankings.

== Embedding a local source code file

You can embed local source code files in AsciiDoc modules.

// The YAML file that you include must be a local file maintained in the link:https://github.com/openshift/openshift-docs[openshift-docs] GitHub repository.

Use the `include` directive to target the local file.

To use a local source code file, add it to the `/<module>/attachments/` directory, and include it in your module. For example:

[source,yaml]
----
\include::attachment$install-config.yml[]
----

[NOTE]
====
Do not include link:https://docs.asciidoctor.org/asciidoc/latest/directives/include-lines/[lines by content ranges]. This approach can lead to content errors when the included file is subsequently updated.
====

[discrete]
=== Using AsciiDoc callouts in the source code

You can use AsciiDoc callouts in the source code file.
Comment out the callout in the YAML file to ensure that file can still be parsed as valid YAML.
Asciidoctor recognises the commented callout and renders it correctly in the output.
For example:

[source,yaml]
----
apiVersion: v1 # <1>
----

// == Indicating Technology Preview features
//
// To indicate that a feature is in Technology Preview, include the `snippets/technology-preview.adoc` file in the feature's assembly or module to keep the supportability wording consistent across Technology Preview features. Provide a value for the `:FeatureName:` variable before you include this module.
//
// [source,text]
// ----
// :FeatureName: The XYZ plug-in
// \include::snippets/technology-preview.adoc[]
// ----
//
// == Indicating deprecated features
//
// To indicate that a feature is deprecated, include the `modules/deprecated-feature.adoc` file in the feature's assembly, or to each relevant assembly such as for a deprecated Operator, to keep the supportability wording consistent across deprecated features. Provide a value for the `:FeatureName:` variable before you include this module.


== Verification of your content

All documentation changes must be verified by a subject matter expert before merging. This includes executing all "Procedure" changes and confirming expected results. There are exceptions for typo-level changes, formatting-only changes, and other negotiated documentation sets and distributions.

// If a documentation change is due to a bug report or Jira issue, the bug/issue should be put on ON_QA when you have a PR ready. After QE approval is given (either in the bug/issue or in the PR), the QE associate should move the bug/issue status to VERIFIED, at which point the associated PR can be merged. It is also ok for the assigned writer to change the status of the bug/issue to VERIFIED if approval for the changes has been provided in another forum (slack, PR, or email). The writer should indicate that the QE team approved the change as a comment in the bug/issue.

== Images

=== Image format

Use `*.png` format images.

=== Block images

To include a block image (an image on its own line):

1. Put the image file in the `modules/<module>/images` folder.
// +
// Ensure that the folder containing your assembly contains an `images` symbolic link to the top-level `images/` directory, otherwise the image will not be found when building the docs.

2. In the `.adoc` content, use this format to link to the image:
+
----
image::<component>:<module>:<image_filename>[<alt_text>]
----
+
Notice the double `::` instead of a single `:`, as seen in inline image usage.
+
.Example
[source,adoc]
----
image::documentation:architecture_and_concepts:l1l2.png[L1 to L2 messaging]
----
+
The image file, `l1l2.png`, is in `modules/architecture_and_concepts/images/`.

=== Inline images


Use this formatting:

----
image:<component>:<module>:<image_filename>[<alt_text>]
----

Note the single `:` instead of a double `::`, as seen in block image usage.

For example:

----
image:documentation:architecture_and_concepts:manage-columns.png[title="Manage Columns icon"]
----

== Formatting

For all of the system blocks including table delimiters, use four characters. For example:

....
|=== for tables
---- for code blocks
....

[NOTE]
====
You can use backticks or other markup in the title for a block, such as a code block `.Example` or a table `.Description` title.
====

=== Code blocks, command syntax, and example output

Code blocks generally show examples of command syntax, example
screen output, and configuration files.

The main distinction between showing command syntax and a command example is
that a command syntax shows readers how to use the command without real values.
An example command, however, shows the command with actual values with an
example output of that command, where applicable.

For example:

....
Run the following command to initialize an account:

[source,terminal]
----
starknet new_account --account <account_name>
----

.Example output
[source,terminal]
----
Account address: 0x04e93e1fb507d23b398f0a09f5873d3a7769b0e7ed40dbbe8fe7a2e8ea831006
Public key: 0x07a328511fa8552cd61aaaa89076fe40c3566f4594f29324aa754d41d7c7c55e
Move the appropriate amount of funds to the account, and then deploy the account
by invoking the 'starknet deploy_account' command.

NOTE: This is a modified version of the OpenZeppelin account contract. The signature is computed
differently.
----
....

This renders as:

> Run the following command to initialize an account:
>
> ----
>starknet new_account --account <account_name>
> ----
>
> .Example output
> ----
> Account address: 0x04e93e1fb507d23b398f0a09f5873d3a7769b0e7ed40dbbe8fe7a2e8ea831006
> Public key: 0x07a328511fa8552cd61aaaa89076fe40c3566f4594f29324aa754d41d7c7c55e
> Move the appropriate amount of funds to the account, and then deploy the account
> by invoking the 'starknet deploy_account' command.
>
> NOTE: This is a modified version of the OpenZeppelin account contract. The signature is computed
differently.
> ----

The following guidelines go into more detail about specific requirements and
recommendations when using code blocks:

* If a step in a procedure is to run a command, make sure that the step
text includes an explicit instruction to "run" or "enter" the command. In most cases,
use one of the following patterns to introduce the code block:

** <Step description> by running the following command:
** <Step description> by entering the following command:
** <Step description>, run the following command:
** <Step description>, enter the following command:

* Any example of command line input must begin with a prompt, as follows:
** A terminal prompt for a normal user should begin with a dollar sign (`$`) prompt:
+
[source,terminal]
----
$ <regular_user_permission_command_line_input>
----
** A terminal prompt for a superuser should begin with a hash symbol (`#`) prompt:
+
[source,terminal]
----
# <superuser_permission_command_line_input>
----
** A terminal prompt for a command in a non-standard shell, such as a Docker shell, should use the prompt of that shell. For example:
+
[source,terminal]
----
root@17617744386d:/app# ./player.py
----
* Avoid using markup in code block. If you must use any markup in code blocks, see the Asciidoctor documentation on source blocks and substitutions:
** link:https://docs.asciidoctor.org/asciidoc/latest/verbatim/source-blocks/[Source Code Blocks]
** link:https://docs.asciidoctor.org/asciidoc/latest/subs/[Substitutions]
+
[CAUTIONI]
====
It can take some trial and error to figure out the correct source block macro to use for the exact markup you want to use.
====

* For all code blocks, you must include an empty line above a code block (unless
that line is introducing block metadata, such as `[source,terminal]` for syntax
highlighting).
+
Acceptable:
+
....
Lorem ipsum

----
$ lorem.sh
----
....
+
Not acceptable:
+
....
Lorem ipsum
----
$ lorem.sh
----
....
+
Without the line spaces, the content is likely to be not parsed correctly.

* Use `[source,terminal]` for CLI commands, and any other commands that you enter in the terminal, to enable
syntax highlighting. Any `[source]` metadata must go on the line directly before
the code block. For example:
+
....
[source,terminal]
----
$ oc get nodes
----
....
+
If you are also showing a code block for the output of the command, use
`[source,terminal]` for that code block as well.

* Use source tags for the programming language used in the code block to enable
syntax highlighting. For example:

** `[source,cairo]`
** `[source,python]`
** `[source,javascript]`
** `[source,json]`

// * Do not use more than one command per code block. For example, the following must
// be split up into three separate code blocks:
// +
// ....
// To create templates you can modify, run the following commands:
//
// [source,terminal]
// ----
// $ oc adm create-login-template > login.html
// ----
//
// [source,terminal]
// ----
// $ oc adm create-provider-selection-template > providers.html
// ----
//
// [source,terminal]
// ----
// $ oc adm create-error-template > errors.html
// ----
// ....

* If your command contains multiple lines and uses callout annotations, you must comment out the callout(s) in the codeblock, as shown in the following example:
+
....
To scale based on the percent of CPU utilization, create a `HorizontalPodAutoscaler` object for an existing object:

[source,terminal]
----
$ oc autoscale <object_type>/<name> \// <1>
  --min <number> \// <2>
  --max <number> \// <3>
  --cpu-percent=<percent> <4>
----
<1> Specify the type and name of the object to autoscale.
<2> Optional: Specify the minimum number of replicas when scaling down.
<3> Specify the maximum number of replicas when scaling up.
<4> Specify the target average CPU utilization over all the pods, represented as a percent of requested CPU.
....

* Separate a command and its related example output into individual code blocks.
This enables a reader to easily copy the command using the *Copy* button image:images/clippy.png[alt="Copy",20,20] on
docs.starknet.io.
+
In addition, prepend the code block for the output with the title `.Example output`
to make it consistently clear across the docs when this is being represented. A
lead-in sentence explaining the example output is optional. For example:
+
....
Run the `starknet new_account` command to initialize an account:

[source,terminal]
----
$ starknet new_account --account <account_name>
----

The output verifies that a new account was intialized:

.Example output
[source,terminal]
----
Account address: 0x04e93e1fb507d23b398f0a09f5873d3a7769b0e7ed40dbbe8fe7a2e8ea831006
Public key: 0x07a328511fa8552cd61aaaa89076fe40c3566f4594f29324aa754d41d7c7c55e
Move the appropriate amount of funds to the account, and then deploy the account
by invoking the 'starknet deploy_account' command.

NOTE: This is a modified version of the OpenZeppelin account contract. The signature is computed
differently.
----
....

* To mark up command syntax, use the code block and wrap any replaceable values in angle brackets (`<>`) with the required command parameter, using underscores (`_`) between words as necessary for legibility. For example:
+
....
To deploy the account you initialized, now run the following command:

[source,terminal]
----
$ starknet deploy_account --account=<account_name>
----
....
+
This renders as:
+
--
> To view a list of objects for the specified object type, enter the following command:
>
> ----
> $ oc get <object_type> <object_id>
> ----
--
+
NOTE: Avoid using full command syntax inline with sentences.

* When you specify link:https://kubernetes.io/docs/reference/kubectl/#resource-types[resource names] in `oc` commands, use the full name of the resource type by default. You can use the abbreviation of the resource type name if it improves readability, such as with very long commands, or to be consistent with existing content in the same assembly.
+
For example, use `namespaces` instead of `ns` and `poddisruptionbudgets` instead of `pdb`.

* When referring to a path to a location that the user has selected or created, treat the part of the path that the user chose as a replaceable value. For example:
+
....
Create a secret that contains the certificate and key in the `openshift-config` namespace:

[source,terminal]
----
$ oc create secret tls <certificate> --cert=<path_to_certificate>/cert.crt --key=<path_to_key>/cert.key -n openshift-config
----
....
+
This renders as:
+
--
> Create a secret that contains the certificate and key in the `openshift-config` namespace:
>
> ----
> $ oc create secret tls <certificate> --cert=<path_to_certificate>/cert.crt --key=<path_to_key>/cert.key -n openshift-config
> ----
--
+
The following example shows a more complex use of user-chosen elements and prescriptive placement:
+
....
<resource_group_name>/providers/Microsoft.Compute/diskEncryptionSets/<disk_encryption_set_name>
....

* If you must provide additional information on what a line of a code block
represents, use callouts (`<1>`, `<2>`, etc.) to provide that information.
+
Use this format when embedding callouts into the code block:
+
[subs=-callouts]
....
----
code example 1 <1>
code example 2 <2>
----
<1> A note about the first example value.
<2> A note about the second example value.
....

* If you must provide additional information on what a line of a code block
represents and the use of callouts is impractical, you can use a description list
to provide information about the variables in the code block. Using callouts
might be impractical if a code block contains too many conditional statements to
easily use numbered callouts or if the same note applies to multiple lines of the codeblock.
+
....
----
code <variable_1>
code <variable_2>
----
+
where:

<variable_1>:: Specifies the explanation of the first variable.
<variable_2>:: Specifies the explanation of the first variable.
....
+
Be sure to introduce the description list with "where:" and start each variable
description with "Specifies."

* For long lines of code that you want to break up among multiple lines, use a
backslash to show the line break. For example:
+
----
$ oc get endpoints --all-namespaces --template \
    '{{ range .items }}{{ .metadata.namespace }}:{{ .metadata.name }} \
    {{ range .subsets }}{{ range .addresses }}{{ .ip }} \
    {{ end }}{{ end }}{{ "\n" }}{{ end }}' | awk '/ 172\.30\./ { print $1 }'
----

* If the user must run a command as root, use a number sign (`#`) at the start of the command instead of a dollar sign (`$`). For example:
+
----
# subscription-manager list
----

* For snippets or sections of a file, use an ellipsis (`...` or `# ...` for YAML) to show that the file continues before or after the quoted block.
+
----
apiVersion: v1
kind: Pod
metadata:
  labels:
    test: liveness
# ...
----
+
or
+
----
Name:               ci-ln-iyhx092-f76d1-nvdfm-worker-b-wln2l
Roles:              worker
...
Taints:             node-role.kubernetes.io/infra:NoSchedule
...
----
+
Do not use `[...]`, `<snip>`, or any other variant.

* Do not use `jq` in commands (unless it is truly required), because this requires users to install the `jq` tool. Oftentimes, the same or similar result can be accomplished using `jsonpath` for `oc` commands.
+
For example, this command that uses `jq`:
+
----
$ oc get clusterversion -o json|jq ".items[0].spec"
----
+
can be updated to use `jsonpath` instead:
+
----
$ oc get clusterversion -o jsonpath='{.items[0].spec}{"\n"}'
----

* For Bash "here" documents use `[source,terminal]`, such as the following example:
+
....
[source,terminal]
----
$ cat <<EOF| oc create -f -
apiVersion: v1
kind: Pod
metadata:
  name: mlistener
  labels:
    app: multicast-verify
EOF
----
....

* For the output of commands use `[source,text]`, such as with the following example output from the `oc describe <pural> <object>` command:
+
....
[source,text]
----
Name:               node1.example.com
Roles:              worker
Labels:             kubernetes.io/arch=amd64
...
Annotations:        cluster.k8s.io/machine: openshift-machine-api/ahardin-worker-us-east-2a-q5dzc
...
CreationTimestamp:  Wed, 13 Feb 2019 11:05:57 -0500
----
....

=== YAML formatting for Kubernetes and OpenShift API objects
The following formatting guidelines apply to YAML manifests, but do not apply to the installation configuration YAML specified by `install-config.yaml`.

When possible, ensure that YAML is valid in a running cluster. You can validate YAML with `oc apply` with the following invocation:

----
$ oc apply -f test.yaml --dry-run=client
----

==== Required fields

- Include the `apiVersion` and `kind` so that a user always knows the context of the YAML.
- Include the full hierarchy to a deeply nested key.
- For objects that are in the global scope, such as for `config.openshift.io` API group, always include the `metadata.name` for the object, which is usually `cluster`.

.Example API object in the global scope
----
apiVersion: config.openshift.io/v1
kind: Scheduler
metadata:
  name: cluster
# ...
spec:
  defaultNodeSelector: node-role.kubernetes.io/app=
# ...
----

.Example deeply nested key with full context for `.ports` array
----
apiVersion: v1
kind: Pod
metadata:
  name: pod1
  namespace: default
spec:
  containers:
  - name: web
    image: nginx
    ports:
    - name: web
      containerPort: 80
      protocol: TCP
----

==== Formatting
The following conventions govern the layout of YAML for API objects:

- Begin YAML at the beginning of the left margin.
- Use two-space indentation.
- Indent arrays at the same depth as the parent field.
- Include a space immediately after the colon for keys.
- Use block style for complex strings, such as embedded JSON or text blocks. You can enable block style by specifying `|` or `|-` after a field and indenting the field content by two spaces, such as in the following example:
+
----
fieldName: |-
  This is a string.
  And it can be on multiple lines.
----
- When truncating YAML, comment out the ellipsis (`# ...`) because three dots (`...`) in YAML is actually a link:https://yaml.org/spec/1.2.2/#22-structures[document end marker].
- Use three hyphens (`---`) to separate YAML definitions in a single YAML file.

.Example with array indentation flush with parent field
----
apiVersion: v1
kind: Pod
metadata:
  name: pod1
  labels:
  - key1: val1
  - key2: val2
spec:
# ...
----

.Example with block string for annotation
----
apiVersion: v1
kind: Pod
metadata:
  name: pod1
  annotations:
    k8s.v1.cni.cncf.io/networks: |-
      [
        {
          "name": "net"
        }
      ]
spec:
# ...
----

=== Inline code or commands
Do NOT show full commands or command syntax inline within a sentence. The next section covers how to show commands and command syntax.

Only use case for inline commands would be general commands and operations, without replaceables and command options. In this case an inline command is marked up using the back ticks:

....
Use the `GET` operation to do x.
....

This renders as:

> Use the `GET` operation to do x.

=== System messages

System messages include error, warning, confirmation, and information messages that are presented to the user in places such as the GUI, CLI, or system logs.

If a message is short enough to include inline, enclose it in back ticks:

....
Previously, image builds and pushes would fail with the `error reading blob from source` error message because the builder logic would compute the contents of new layers twice.
....

This renders as:

> Previously, image builds and pushes would fail with the `error reading blob from source` error message because the builder logic would compute the contents of new layers twice.

If a message is too long to include inline, put it inside a code block with `[source,text]` metadata:

....
Previously, the AWS Terraform provider that the installation program used occasionally caused a race condition with the S3 bucket, and the cluster installation failed with the following error message:

[source,text]
----
When applying changes to module.bootstrap.aws_s3_bucket.ignition, provider level=error msg="\"aws\" produced an unexpected new value for was present, but now absent.
----

Now, the installation program uses different AWS Terraform provider code, which now robustly handles S3 eventual consistency, and the installer-provisioned AWS cluster installation does not fail with that error message.
....

This renders as:

> Previously, the AWS Terraform provider that the installation program used occasionally caused a race condition with the S3 bucket, and the cluster installation failed with the following error message:
>
> ----
> When applying changes to module.bootstrap.aws_s3_bucket.ignition, provider level=error msg="\"aws\" produced an unexpected new value for was present, but now absent.
> ----
>
> Now, the installation program uses different AWS Terraform provider code, which now robustly handles S3 eventual consistency, and the installer-provisioned AWS cluster installation does not fail with that error message.

NOTE: Always refer to a message with the type of message it is, followed by the word "message". For example, refer to an error message as an "error message", and not simply as an "error".

=== Lists
Lists are created as shown in this example:

....
. Item 1 (2 spaces between the period and the first character)

. Item 2

. Item 3
....

This renders as:

> . Item 1
> . Item 2
> . Item 3

If you must add any text, admonitions, or code blocks you have to add the continuous +, as shown in the example:

....
. Item 1
+
----
some code block
----

. Item 2

. Item 3
....

This renders as:

> . Item 1
> +
> ----
> some code block
> ----
> . Item 2
> . Item 3

=== Footnotes

Avoid footnotes when possible.

If you reference a footnote from only a single location, use the following syntax:

.Footnote
....
footnote:[This is the footnote text.]
....

If you reference a footnote from multiple locations, set an attribute with the footnote text. As a consequence, this will duplicate the footnote text at bottom of the page.

.Footnote with text set by an attribute
....
:note-text: This is a footnote.

This text has a footnote qualifier attached footnote:[{note-text}].

But this other text uses the same qualifier elsewhere footnote:[{note-text}].
....

Avoid using `footnoteref`.

[IMPORTANT]
====
The `footnoteref` directive is deprecated in asciidoctor and causes a build warning when `ascii_binder` is run.
====

.Footnote with reference
....
footnoteref:[ref-string, This is the footnote text.]
....

==== Alternative footnote styling in tables

For footnotes in tables, use the following syntax to mimic Asciidoctor's
styling:

....
[cols="3",options="header"]
|===
|Header 1
|Header 2
|Header 3

|Item A ^[1]^
|Item B
|Item C ^[2]^

|Item D
|Item E ^[3]^
|Item F ^[3]^
|===
[.small]
--
1. A description.
2. Another description.
3. Two items relate to this description.
--
....

The notes are kept immediately after the table, instead of moved to the bottom of the rendered assembly. This manual method also allows you to reuse the same footnote number for multiple references as needed.

Note the following:

* Add a space before the superscripted numbers with square brackets.
* To match the table cell's font size, start the ordered list with a `[.small]`
style and wrap it in a `--` block.

[id="collapsible-content"]
=== Collapsible content
You can collapse sections of content by using the `collapsible` option, which converts the Asciidoctor markup to HTML `details` and `summary` sections. The `collapsible` option is used at the writer's discretion and is appropriate for considerably long code blocks, lists, or other such content that significantly increases the length of a module or assembly.

[NOTE]
====
You must set a title for the `summary` section. If a title is not set, the default title is "Details."
====

Collapsible content is formatted as shown:

....
.Title of the `summary` dropdown
[%collapsible]
====
This is content within the `details` section.
====
....

This renders as a dropdown with collapsed content:

.Title of the `summary` dropdown
[%collapsible]
====
This is content within the `details` section.
====

If your collapsible content includes an admonition such as a note or warning, the admonition must be nested:

....
.Collapsible content that includes an admonition
[%collapsible]
====
This content includes an admonition.

[source,terminal]
----
$ oc whoami
----

[NOTE]
=====
Nest admonitions when using the `collapsible` option.
=====
====
....

This renders as:

.Collapsible content that includes an admonition
[%collapsible]
====
This content includes an admonition.

[source,terminal]
----
$ oc whoami
----

[NOTE]
=====
Nest admonitions when using the `collapsible` option.
=====
====

=== Quick reference

.User accounts and info
[option="header"]
|===
|Markup in command syntax |Description |Substitute value in Example block

|`<username>`
|Name of user account
|user@example.com

|`<password>`
|User password
|password
|===

.Projects and applications
[option="header"]
|===
|Markup in command syntax |Description |Substitute value in Example block

|`<project>`
|Name of project
|myproject

|`<app>`
|Name of an application
|myapp
|===

=== Additional resources sections

The following guidelines apply to all "Additional resources" sections:

* You must include the `[role="_additional-resources"]` attribute declaration before the section heading.
* You must not include paragraphs in the section. Use an unordered list.
* The links and xrefs in the unordered list must contain human-readable text between the square brackets.
* Each item in the unordered list must contain a minimum of text besides the link or xref.

Additionally, in an assembly, use `==` formatting for the section heading (`== Additional resources`). Use of this heading syntax at the assembly level indicates that the sections relate to the whole assembly. For example:

----
[role="_additional-resources"]
[id="additional-resources_configuring-alert-notifications"]
== Additional resources
* link:some-url.com[Human readable label]
* xref:some_xref[Human readable label]
* xref:some_other_xref[Human readable label]
----

Only use `.` formatting (`.Additional resources`) in a module or to follow a module in an assembly. Because you cannot use the xrefs in modules, this functions as a _trailing include_ at the assembly level, where the `.` formatting of the `include` statement indicates that the resource applies specifically to the module and not to the assembly. For example:

----
[role="_additional-resources"]
.Additional resources
* link:some-url.com[Human readable label]
* xref:some_xref[Human readable label]
* xref:some_other_xref[Human readable label]
----

== Admonitions
Admonitions such as notes and warnings are formatted as shown:

....
[ADMONITION]
====
Text for admonition
====
....

[id="api-object-formatting"]
== API object formatting

For terms that are API objects, the way they are written depends on whether the term is a general reference or an actual reference to the object.

[id="api-object-general-references"]
=== General references

A general reference is any time you are speaking conceptually, or generally, about these components in a cluster.

When referring to API object terms in general usage, use lowercase and separate multi-word API objects. *Default to following this guidance unless you are specifically interacting with/referring to the API object (see xref:api-object-object-references[Object references]).*

For example:

* pod
* node
* daemon set
* config map
* deployment
* image stream
* persistent volume claim

.Examples of general references
....
Kubernetes runs your workload by placing containers into pods to run on nodes.

You must have at least one secret, config map, or service account.

The total number of persistent volume claims in a project.
....

Note that if an object uses an acronym or other special capitalization, then its general reference should honor that. For example, general references to `APIService` should be written as "API service", not "api service". Any other exceptions or special guidance are noted in the xref:../contributing_to_docs/term_glossary.adoc[glossary].

[id="api-object-object-references"]
=== Object references

An object reference is when you are referring to the actual instance of an API object, where the object name is important.

When referring to actual instances of API objects, use link:https://en.wikipedia.org/wiki/Camel_case#Variations_and_synonyms[PascalCase] and mark it up as monospace in backticks (````).

[NOTE]
====
Do not use backticks or other markup in assembly or module headings. You can use backticks or other markup in the title for a block, such as a code block `.Example` or a table `.Description` title.
====

Be sure to match the proper object type (or `kind` in Kubernetes terms); for example, do not add an "s" to make it plural. *Only follow this guidance if you are explicitly referring to the API object (for example, when editing an object in the CLI or viewing an object in the web console).*

For example:

* `Pod`
* `Node`
* `DaemonSet`
* `ConfigMap`
* `Deployment`
* `ImageStream`
* `PersistentVolumeClaim`

.Examples of API object references
....
After you create a `Node` object, or the kubelet on a node self-registers, the control plane checks whether the new `Node` object is valid.

The default amount of CPU that a container can use if not specified in the `Pod` spec.

Create a file, `pvc.yaml`, with the `PersistentVolumeClaim` object definition.
....

[NOTE]
====
Use "object", "resource", "custom resource", "spec", etc. as appropriate after the object reference. This helps with clarity and readability.

Another situation where this is necessary is when referring to the plural version of objects. Do not add an "s" to the end of an object name reference to make it plural. Use only the official `kind` of object (for example, seen when you run `oc api-resources`).

For example, the object `kind` for a node is `Node`, not `Nodes`. So do not write "You can create `Nodes` using `kubectl`." Instead, rewrite to something like "You can create `Node` objects using `kubectl`."
====

[id="operator-name-capitalization"]
=== Operator capitalization

The term "Operator" is always capitalized. For example:

----
= Support policy for unmanaged Operators

Individual Operators have a `managementState` parameter in their configuration.
----

An Operator's full name must be a proper noun, with each word initially
capitalized. If it includes a product name, defer the product's capitalization
style guidelines. For example:

- Red Hat OpenShift Logging Operator
- Prometheus Operator
- etcd Operator
- Node Tuning Operator
- Cluster Version Operator

== Declarative config examples

Many of our procedures provide imperative `oc` commands (which cannot be stored in a Git repo). Due to efforts around improving the experience for GitOps users, we sometimes also want to provide a declarative YAML example that achieves the same configuration. This allows users to store these YAML configurations in a Git repo and follow GitOps practices to configure OpenShift.

[IMPORTANT]
====
When adding declarative examples to procedures, do not completely replace the imperative command with the declarative YAML example. Some users might still prefer the imperative option.
====

To add a declarative YAML example to a procedure step with an existing imperative command, add it in a "TIP" admonition by following the template in the example below. This example uses an imperative command (`oc create configmap`) to create a config map, and then provides the declarative YAML example of the `ConfigMap` object afterward.

....
* Define a `ConfigMap` object containing the certificate authority by using the following command:
+
[source,terminal]
----
$ oc create configmap ca-config-map --from-file=ca.crt=/path/to/ca -n openshift-config
----
+
[TIP]
====
You can alternatively apply the following YAML to create the config map:

[source,yaml]
----
apiVersion: v1
kind: ConfigMap
metadata:
  name: ca-config-map
  namespace: openshift-config
type: Opaque
data:
  ca.crt: <base64_encoded_CA_certificate_PEM>
----
====
....

This renders as:

> * Define a `ConfigMap` object containing the certificate authority by using the following command:
> +
> [source,terminal]
> ----
> $ oc create configmap ca-config-map --from-file=ca.crt=/path/to/ca -n openshift-config
> ----
> +
> [TIP]
> ====
> You can alternatively apply the following YAML to create the config map:
>
> [source,yaml]
> ----
> apiVersion: v1
> kind: ConfigMap
> metadata:
>   name: ca-config-map
>   namespace: openshift-config
> type: Opaque
> data:
>   ca.crt: <base64_encoded_CA_certificate_PEM>
> ----
> ====

[NOTE]
====
If you are adding a particularly long YAML block, you can optionally use the xref:collapsible-content[`%collapsible`] feature to allow users to collapse the code block.
====

== Quick markup reference

|===
|Convention |Markup |Example rendered output

|Code blocks

a|
....
Use the following syntax for the `oc` command:

----
$ oc <action> <object_type> <object_name_or_id>
----
....

a|
> Use the following syntax for the `oc` command:
>
> ----
> $ oc <action> <object_type> <object_name_or_id>
> ----

a|Use backticks for all non-GUI "system items", including:

* Inline commands, operations, literal values, variables, parameters, settings,
flags, environment variables, user input
* System term/item, user names, unique or example names for individual API
objects/resources (e.g., a pod named `mypod`), daemon, service, or software
package
* RPM packages
* File names or directory paths

a|
....
`oc get`

Set the `upgrade` variable to `true`.

Use the `--amend` flag.

Answer by typing `Yes` or `No` when prompted.

`user_name`

`service_name`

`package_name`

`filename`
....

a|
> Use the `oc get services` command to get a list of services that are currently defined.
>
> &nbsp;
>
> Use the `--amend` flag.
>
> &nbsp;
>
> Set the `upgrade` variable to `true`.
>
> &nbsp;
>
> Answer by typing `Yes` or `No` when prompted.
>
> &nbsp;
>
> `cluster-admin` user
>
> &nbsp;
>
> `firewalld` service
>
> &nbsp;
>
> `rubygems` RPM package
>
> &nbsp;
>
> The `express.conf` configuration file is located in the `/usr/share` directory.

|System or software variable to be replaced by the user
a|
....
`<project>`

`<deployment>`

`<install_mode_value>`
....

a|
> Use the following command to roll back a Deployment, specifying the Deployment name:
>
> `oc rollback <deployment>`
>
> &nbsp;
>
> Apply the new configuration file:
>
> `oc apply -f <path_to_configuration_file>/<filename>.yaml`

|Use single asterisks for web console / GUI items (menus, buttons, page titles, etc.).
Use two characters to form the arrow in a series of menu items (`$$->$$`).

a|
....
Choose *Cluster Console* from the list.

Navigate to the *Operators* -> *Catalog Sources* page.

Click *Create Subscription*.
....

a|
> Choose *Cluster Console* from the list.
>
> &nbsp;
>
> Navigate to the *Operators* -> *Catalog Sources* page.
>
> &nbsp;
>
> Click *Create Subscription*.

|Use underscores to emphasize the first appearance of a new term.

a|
....
An _Operator_ is a method of packaging, deploying,
and managing a Kubernetes application.
....

a|
> An _Operator_ is a method of packaging, deploying, and managing a Kubernetes application.

|Use of underscores for general emphasis is allowed but should only be used
very sparingly. Let the writing, instead of font usage, create the emphasis
wherever possible.

a|
....
Do _not_ delete the file.
....

a|
> Do _not_ delete the file.

|Footnotes

|A footnote is created with the footnote macro. If you plan to reference a footnote more than once, use the ID footnoteref macro. The Customer Portal does not support spaces in the footnoteref. For example, "dynamic PV" should be "dynamicPV".

|For footnote and footnoteref syntax, see link:http://asciidoctor.org/docs/user-manual/#user-footnotes[AsciiDoctor documentation].

|===